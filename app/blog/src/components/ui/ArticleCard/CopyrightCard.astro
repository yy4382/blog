---
import { Icon } from "astro-icon/components";
import { card } from "@styles/tv";
import Sign from "@assets/signature-yunfi.svg?raw";
const { base } = card();
const cardClass = base({
  padding: "sm",
  class: `relative overflow-hidden`,
});
---

<div class={cardClass}>
  <div
    class:list={[
      "prose !text-sm opacity-80 dark:prose-invert prose-p:text-comment prose-a:!text-content",
    ]}
  >
    <div class="signature-wrapper float-right">
      <Fragment set:html={Sign} />
    </div>
    <p class="!mt-0 !mb-2">
      本文使用“<a
        href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en"
        >署名-非商业性使用-相同方式共享 4.0 国际(CC BY-NC-SA 4.0)</a
      >”进行许可。
    </p>
    <p class="!mt-0">
      商业转载请联系站长获得授权，非商业转载请注明本文出处及文章链接。
      如果您再混合、转换或者基于本作品进行创作，您必须基于<a
        href="https://creativecommons.org/share-your-work/licensing-considerations/compatible-licenses/"
        >相同的</a
      >协议分发您贡献的作品。
    </p>
  </div>

  <div
    class="absolute -right-4 -bottom-4 flex gap-2 text-8xl text-black opacity-5 md:text-[8rem] dark:text-white"
  >
    <Icon name="fa6-brands:creative-commons" />
  </div>
</div>

<style is:global>
  /* TODO: temp workaround for tailwind v4 beta, https://github.com/tailwindlabs/tailwindcss/issues/15219 */
  @import "tailwindcss/theme" theme(reference);
  @import "../../../styles/theme.css" theme(reference);

  .signature-wrapper {
    --signature-length: 2550px;
    & > svg {
      @apply ml-4 h-auto w-20 opacity-100 sm:-mt-1 sm:-mr-3;
    }
  }
  /* https://antfu.me/posts/animated-svg-logo */
  .signature-wrapper #main-stroke {
    @apply stroke-black opacity-100 dark:stroke-white;
    stroke-dashoffset: 1px;
    stroke-dasharray: var(--signature-length) 0;
    animation: grow 7s ease-out forwards infinite;
    transform-origin: center;
    animation-delay: 0s;
  }
  @media (prefers-reduced-motion) {
    path {
      animation: none !important;
      stroke-dasharray: unset !important;
    }
  }
  @keyframes grow {
    0% {
      stroke-dashoffset: 1px;
      stroke-dasharray: 0 var(--signature-length);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    45% {
      stroke-dasharray: var(--signature-length) 0;
    }
    /* Moving back */
    65% {
      stroke-dasharray: var(--signature-length) 0;
    }
    95%,
    to {
      stroke-dasharray: 0 var(--signature-length);
    }
  }
</style>
